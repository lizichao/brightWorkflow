Ext.namespace("jsp.platform.sm");jsp.platform.sm.select_dept_or_user=function(){var __caches__=[];this.__caches__=__caches__;
var SelectRecord=Ext.data.Record.create([{xtype:"Field",name:"nid",fieldLabel:"节点ID",type:"string",allowBlank:true},{xtype:"Field",name:"pid",fieldLabel:"父节点ID",type:"string",allowBlank:true},{xtype:"Field",name:"ncode",fieldLabel:"节点代码",type:"string",allowBlank:true},{xtype:"Field",name:"nm",fieldLabel:"节点名称",type:"string",allowBlank:true},{xtype:"Field",name:"nod",fieldLabel:"节点类型",type:"string",allowBlank:true},{xtype:"Field",name:"childnum",fieldLabel:"子节点数",type:"string",allowBlank:true}]);this.SelectRecord=SelectRecord;this.__caches__.push(SelectRecord);
var MainPanel=new Ext.Panel({layout:'fit',border:false,bodyBorder:false,items:[{xtype:"treepanel",height:400,animate:true,itemId:"SelectUserOrDeptTree",id:"SelectUserOrDeptTree",autoScroll:true,containerScroll:true,collapsible:false,frame:true,titleCollapse:false,rootVisible:false,root:new Ext.tree.AsyncTreeNode({id:JrafSession.get('deptid')}),loader:new JrafXmlTreeLoader({nparams:{nid:'nid',pid:'pid',ntext:'{nm}',loadAll:false,isLeaf:'childnum',expanded:true,chk:true,chkfld:'selected_flag',chkval:'Y',sm:'folder|leaf|all',icon:'icon'},action:{sysName:'pcmc',oprID:'dept',actions:'getCurDeptUserList'},baseParams:{PageSize:'-1'}}),buttons:[{text:'确定',handler:function(){var selectIdS='';var selectNames='';var ckrs=Ext.getCmp('SelectUserOrDeptTree').getChecked();for(var i=0;i<ckrs.length;i++){var node=ckrs[i];var rec=node.attributes.record;selectIdS=selectIdS+rec.data['nod']+'-'+rec.data['nid']+';';selectNames=selectNames+rec.data['nm']+';';}
var resultArray=new Array(2);resultArray[0]=selectIdS;resultArray[1]=selectNames;window.returnValue=resultArray;window.close();}},{text:'取消',handler:function(){window.returnValue='';window.close();}}]}]});this.MainPanel=MainPanel;
var __jrafonload=function(_params_){};this.__jrafonload=__jrafonload;this.__caches__.push(__jrafonload);};