var myDate=new Date,timestamp=myDate.getFullYear()+""+myDate.getMonth()+1+myDate.getDate()+myDate.getHours()+myDate.getMinutes();seajs.config({base:staticPath,alias:aliasContent,map:[[/^(.*\.(?:css|js))(.*)$/i,"$1?version="+timestamp]]}),seajs.use("tizi_msg",function(ex){ex.errormsg()}),seajs.use("tizi_notice",function(ex){ex.getNotice()}),seajs.use("tizi_login_form",function(ex){ex.loginCheckClick(),ex.logoutCheckClick()});var Common={getLeftBar:function(obj){$(obj.id).css("height",$(document).height()-80)},headerNav:function(json){var _id=json.id,_ul=json.ul,_dis=json.dis;$(_id).hover(function(){$(this).find(_ul).addClass(_dis)},function(){})},inputTips:function(id){var txt=$(id).val();$(id).focus(function(){"请输入关键字"==$(id).val()&&$(id).val("")}),$(id).blur(function(){""==$(id).val()&&$(id).val(txt)})}};Common.comValidform={detectFlashSupport:function(fn_noflash,fn_flash){void 0==fn_noflash&&(fn_noflash=function(){}),void 0==fn_flash&&(fn_flash=function(){});var hasFlash=!1;if("function"==typeof ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(hasFlash=!0)}catch(error){}!hasFlash&&navigator.mimeTypes["application/x-shockwave-flash"]&&(hasFlash=!0),hasFlash?fn_flash():fn_noflash()}},Common.floatLoading={showLoading:function(){},hideLoading:function(){},showFloatLoading:function(){$(".floatLoadingCover").length<1&&$("body").append('<div class="floatLoadingCover"></div><div class="cFloatLoadingGif"><span></span><p class="return undis"><a href="javascript:void(0)">返回上页</a></p></div>'),$(".return").hide(),this.loadingDivShow(),this.returnPre()},hideFloatLoading:function(){$(".floatLoadingCover").hide(),$(".cFloatLoadingGif").hide(),clearInterval(this.timers),clearInterval(this.timerID),$(".return").hide()},loadingDivShow:function(){$(".floatLoadingCover").css("height",$(window).height()).show(),$(".cFloatLoadingGif").show()},returnPre:function(){$(".return").show(),$(".return").click(function(){Common.floatLoading.hideFloatLoading()})}},Common.Msg={ErrorMsg:$("#errormsg"),errormsg:function(){void 0!=this.ErrorMsg.html()&&""!=this.ErrorMsg.html()&&$.tiziDialog({content:this.ErrorMsg.html()})}},Common.Msg.errormsg(),Common.valid={paperHaveError:{addPaperHaveError:function(){var _Form=$(".haveErrorForm").Validform({tiptype:3,showAllError:!1,ajaxPost:!0,beforeSubmit:function(){var picture_urls="";$(".picture_urls").each(function(){picture_urls+=""===picture_urls?"":",",picture_urls+=$(this).attr("src")}),$("#picture_urls").val(picture_urls)},callback:function(data){CommonAjax.paperHaveError.addPaperHaveError(data)}});_Form.addRule([{ele:".lite_textarea",datatype:"*",nullmsg:"错误描述不能为空",errormsg:"错误描述不能为空"},{ele:":checkbox:first",datatype:"*",nullmsg:"错误类型不能为空",errormsg:"错误类型不能为空"}])}},paperFavoritError:{paperFavoritHaveError:function(){var _Form=$(".paperFavoritForm").Validform({tiptype:3,showAllError:!1,ajaxPost:!0,beforeSubmit:function(){},callback:function(data){CommonAjax.paperFavoritHaveError.addSaveHaveError(data)}});_Form.addRule([{ele:":select",datatype:"*",nullmsg:"请选择分组",errormsg:"选择错误"}])}},bindAqStart:function(){$(".aq_startForm").Validform({tiptype:3,showAllError:!1,ajaxPost:!0,beforeSubmit:function(){var subject_id=($("#aq_question_id").val(),$("#aq_subject").val()),grade=$("#aq_grades").val(),content=$("#content").html(),picture_urls="";return $(".picture_urls").each(function(){picture_urls+=""===picture_urls?"":",",picture_urls+=$(this).attr("src")}),$("#picture_urls").val(picture_urls),$("#textareaContent").val(content),0==subject_id||0==grade?($.tiziDialog({content:"请选择科目和年级"}),!1):""===$.trim(content)?($.tiziDialog({content:"提问内容不能为空"}),!1):void 0},callback:function(data){CommonAjax.Aq.AqStart(data)}})},complaint:function(){var _Form=$(".complaintConentForm").Validform({tiptype:3,showAllError:!1,beforeSubmit:function(){var checkcode=$(".textCaptcha").val();return Common.comValidform.checkCaptcha(checkcode,1)},ajaxPost:!0,callback:function(data){CommonAjax.Aq.complaint(data)}});_Form.addRule([{ele:".contentTextarea",datatype:"*5-1000",nullmsg:"请填写投诉内容！",errormsg:"投诉内容5-1000个字符之间！"},{ele:".tel",datatype:"m | /^\\w{0}$/"},{ele:".textCaptcha"}])},homeworkSaveTitle:function(save_as){var _Form=$(".commonSaveTitleForm").Validform({tiptype:3,showAllError:!1,ajaxPost:!0,beforeSubmit:function(){return $("#save-btn, #saveas-btn").attr("class").indexOf("disabled")>0?!1:($("#save-btn,#saveas-btn").addClass("disabled"),$("#save_as").val(save_as),void 0)},callback:function(data){if($("#save-btn,#saveas-btn").removeClass("disabled"),data.errorcode){var save_title=$("#save_title").val();$.tiziDialog.list.commonSaveTitle.close(),$.tiziDialog({content:data.error,okVal:"去布置",icon:"succeed",ok:function(){window.location.href=baseUrlName+"teacher/homework/center"},cancelVal:"继续编辑",cancel:!0}),$(".preview-title").find("h3").html(save_title)}else $.tiziDialog({content:data.error})}});_Form.addRule([{ele:"#save_title",datatype:"*1-20",nullmsg:"请输入标题名称",errormsg:"长度20个字符以内"}])},paperSaveTitle:function(save_as){var _Form=$(".commonSaveTitleForm").Validform({tiptype:3,showAllError:!1,ajaxPost:!0,beforeSubmit:function(){return $("#save-btn, #saveas-btn").attr("class").indexOf("disabled")>0?!1:($("#save-btn,#saveas-btn").addClass("disabled"),$("#save_as").val(save_as),void 0)},callback:function(data){if($("#save-btn,#saveas-btn").removeClass("disabled"),data.errorcode){var save_title=$("#save_title").val();$.tiziDialog.list.commonSaveTitle.close(),$.tiziDialog({content:data.error,icon:"succeed",okVal:"去下载",ok:function(){window.location.href=baseUrlName+"teacher/paper/center"},cancelVal:"继续编辑",cancel:!0}),$(".preview-title").find("h3").html(save_title)}else $.tiziDialog({content:data.error})}});_Form.addRule([{ele:"#save_title",datatype:"*1-20",nullmsg:"请输入标题名称",errormsg:"长度20个字符以内"}])}},CommonAjax={},CommonAjax.paperHaveError={addPaperHaveError:function(data){if(0==data.errorcode)$.tiziDialog({content:data.error});else{var content="<p>纠错信息提交成功！</p><p>非常感谢您的反馈，我们会尽快处理。</p>";$.tiziDialog({content:content}),art.dialog.list.createHaveError.close()}}},CommonAjax.paperFavoritHaveError={addSaveHaveError:function(data){if(0==data.errorcode)$.tiziDialog({content:data.error});else{var content="<p>收藏成功！</p>";$.tiziDialog({content:content}),art.dialog.list.paperFavoritHaveError.close()}}},CommonAjax.Aq={complaint:function(res){res.errorcode?(art.dialog.list.complaintId.close(),$.tiziDialog({content:"感谢您使用我们的产品！我们将会在3个工作日内处理您的投诉。",icon:"succeed",time:2})):$.tiziDialog({content:res.error,icon:null})},AqStart:function(data){var json=data;json.error>0?$.tiziDialog({icon:"succeed",content:"提问成功",ok:function(){window.location.href=baseUrlName+"student/question/detail/"+json.error}}):$.tiziDialog({content:json.error})}};